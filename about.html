<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About - School Library Management System</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>üìö School Library</h2>
            </div>
            <div class="nav-menu" id="nav-menu">
                <a href="index.html" class="nav-link">Home</a>
                <a href="about.html" class="nav-link active">About</a>
                <div class="auth-links">
                    <button class="btn btn-primary" id="student-login-btn">Student Login</button>
                </div>
            </div>
            <div class="hamburger" id="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        <div class="container">
            <!-- Hero Section -->
            <section class="about-hero">
                <h1 class="page-title">About Our Library</h1>
                <p class="hero-subtitle">Serving the educational needs of Filipino students since 2023</p>
            </section>

            <!-- Mission & Vision -->
            <section class="mission-vision">
                <div class="grid grid-2">
                    <div class="card">
                        <div class="card-header">
                            <h2>üéØ Our Mission</h2>
                        </div>
                        <div class="card-body">
                            <p>To provide equitable access to information resources and services that support the educational, research, and cultural needs of our academic community. We strive to create an environment that fosters lifelong learning and academic excellence.</p>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h2>üëÅÔ∏è Our Vision</h2>
                        </div>
                        <div class="card-body">
                            <p>To be a leading academic library in the Philippines, recognized for excellence in service, innovation, and commitment to lifelong learning. We aim to be the heart of the academic community, supporting the educational journey of every student.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Library Information -->
            <section class="library-info">
                <div class="card">
                    <div class="card-header">
                        <h2>üè´ Library Information</h2>
                    </div>
                    <div class="card-body">
                        <div class="grid grid-2">
                            <div>
                                <h3>Library Hours</h3>
                                <ul class="info-list">
                                    <li>üìÖ <strong>Monday - Friday:</strong> 8:00 AM - 6:00 PM</li>
                                    <li>üìÖ <strong>Saturday:</strong> 9:00 AM - 3:00 PM</li>
                                    <li>üìÖ <strong>Sunday:</strong> Closed</li>
                                    <li>üìÖ <strong>Holidays:</strong> Special hours announced</li>
                                </ul>
                            </div>
                            <div>
                                <h3>Contact Information</h3>
                                <ul class="info-list">
                                    <li>üìç <strong>Location:</strong> DCSA Fairview Branch</li>
                                    <li>üìû <strong>Phone:</strong> (+63) 970 929 0000</li>
                                    <li>üìß <strong>Email:</strong> dcsa@school.edu.ph</li>
                                    <li>üë• <strong>Librarian:</strong> Ms. Librarian Name</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

           

            <!-- Rules & Policies -->
            <section class="policies">
                <div class="card">
                    <div class="card-header">
                        <h2>üìã Library Rules & Policies</h2>
                    </div>
                    <div class="card-body">
                        <div class="grid grid-2">
                            <div>
                                <h3>Borrowing Policies</h3>
                                <ul class="policy-list">
                                    <li>‚úÖ Borrowing period: 14 days</li>
                                    <li>‚úÖ Renewals allowed if no reservations</li>
                                    <li>‚úÖ Return books on or before due date</li>
                                </ul>
                            </div>
                            <div>
                                <h3>General Rules</h3>
                                <ul class="policy-list">
                                    <li>üîá Maintain silence in reading areas</li>
                                    <li>üì± Silent mode for mobile devices</li>
                                    <li>üö´ No food or drinks in library</li>
                                    <li>üíª Use computers for academic purposes only</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

          
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>üìö School Library</h3>
                    <p>Empowering education through accessible knowledge and resources for Filipino students.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="#" id="footer-student-login">Student Login</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact Info</h4>
                    <p>üìç DCSA Fairview Branch</p>
                    <p>üìû (+63) 970 929 0000</p>
                    <p>üìß dcsa@school.edu.ph</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 DCSA Library Management System. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Login Modal -->
    <div id="login-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Student Login</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="login-error" class="error-message" style="display: none;">
                    <!-- Error messages will appear here -->
                </div>
                <div class="form-group">
                    <label for="student-email" class="form-label">Email</label>
                    <input type="email" id="student-email" class="form-control" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="student-password" class="form-label">Password</label>
                    <input type="password" id="student-password" class="form-control" placeholder="Enter your password" required>
                </div>
                <div class="form-group">
                    <button class="btn btn-primary btn-block" id="student-login-submit">
                        <span class="btn-icon">üîê</span> Login to Dashboard
                    </button>
                </div>
                <div class="login-info">
                    <p><strong>Need an account?</strong> Please contact the library administrator to create your student account.</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://oyuuvsqqkdzbrkntmkyt.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im95dXV2c3Fxa2R6YnJrbnRta3l0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1MDEzNDQsImV4cCI6MjA3NzA3NzM0NH0.lz7lhuARXcMljy4so7pNJ6hkLca6MFhaCHqZreBeWls';

        // Initialize Supabase client
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Toast notification function
        function showToast(message, type = 'success') {
            let toastContainer = document.querySelector('.toast-container');
            if (!toastContainer) {
                toastContainer = document.createElement('div');
                toastContainer.className = 'toast-container';
                document.body.appendChild(toastContainer);
            }
            
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <span>${message}</span>
                <button class="toast-close" style="background: none; border: none; color: inherit; font-size: 1.2rem; cursor: pointer;">&times;</button>
            `;
            
            toastContainer.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 5000);
            
            toast.querySelector('.toast-close').addEventListener('click', () => {
                toast.remove();
            });
            
            return toast;
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Hamburger menu
            const hamburger = document.getElementById('hamburger');
            const navMenu = document.getElementById('nav-menu');
            
            if (hamburger && navMenu) {
                hamburger.addEventListener('click', () => {
                    hamburger.classList.toggle('active');
                    navMenu.classList.toggle('active');
                });
            }

            // Modal functionality
            const loginModal = document.getElementById('login-modal');

            // Show login modal
            document.getElementById('student-login-btn').addEventListener('click', () => {
                loginModal.style.display = 'flex';
            });

            document.getElementById('footer-student-login').addEventListener('click', (e) => {
                e.preventDefault();
                loginModal.style.display = 'flex';
            });

            // Close modal
            document.querySelector('.modal-close').addEventListener('click', () => {
                loginModal.style.display = 'none';
            });

            window.addEventListener('click', (e) => {
                if (e.target === loginModal) {
                    loginModal.style.display = 'none';
                }
            });

// Handle student login
document.getElementById('student-login-submit').addEventListener('click', async () => {
    const email = document.getElementById('student-email').value;
    const password = document.getElementById('student-password').value;
    const errorDiv = document.getElementById('login-error');
    
    // Reset error states
    errorDiv.style.display = 'none';
    document.getElementById('student-email').classList.remove('error');
    document.getElementById('student-password').classList.remove('error');
    
    if (!email || !password) {
        showError('Please fill in all fields');
        showToast('Please fill in all fields', 'error');
        return;
    }
    
    try {
        // Show loading state
        const loginBtn = document.getElementById('student-login-submit');
        const originalText = loginBtn.innerHTML;
        loginBtn.innerHTML = '<span class="btn-icon">‚è≥</span> Logging in...';
        loginBtn.disabled = true;

        const { data, error } = await supabase.auth.signInWithPassword({
            email,
            password
        });
        
        if (error) {
            handleLoginError(error);
            showToast(error.message, 'error');
            loginBtn.innerHTML = originalText;
            loginBtn.disabled = false;
            return;
        }
        
        // Get user profile to check role
        const { data: userProfile, error: profileError } = await supabase
            .from('users')
            .select('role')
            .eq('id', data.user.id)
            .single();
        
        if (profileError) {
            console.error('Error fetching user profile:', profileError);
            showError('Error verifying account. Please try again.');
            showToast('Error verifying account. Please try again.', 'error');
            loginBtn.innerHTML = originalText;
            loginBtn.disabled = false;
            return;
        }
        
        if (userProfile && userProfile.role === 'student') {
            showSuccess('Login successful! Redirecting to dashboard...');
            showToast('Login successful! Redirecting...', 'success');
            setTimeout(() => {
                window.location.href = 'student/dashboard.html';
            }, 1500);
        } else {
            showError('Access denied. Student account required.');
            showToast('Access denied. Student account required.', 'error');
            await supabase.auth.signOut();
            loginBtn.innerHTML = originalText;
            loginBtn.disabled = false;
        }
        
    } catch (error) {
        console.error('Login error:', error);
        showError('Login failed. Please try again.');
        showToast('Login failed. Please try again.', 'error');
        const loginBtn = document.getElementById('student-login-submit');
        loginBtn.innerHTML = '<span class="btn-icon">üîê</span> Login to Dashboard';
        loginBtn.disabled = false;
    }
});

// Helper functions for error handling
function showError(message) {
    const errorDiv = document.getElementById('login-error');
    errorDiv.innerHTML = message;
    errorDiv.style.display = 'block';
    errorDiv.className = 'error-message';
}

function showSuccess(message) {
    const errorDiv = document.getElementById('login-error');
    errorDiv.innerHTML = message;
    errorDiv.style.display = 'block';
    errorDiv.className = 'success-message';
}

function handleLoginError(error) {
    console.error('Login error:', error);
    
    if (error.message.includes('Invalid login credentials')) {
        showError('Invalid email or password. Please check your credentials and try again.');
        document.getElementById('student-password').classList.add('error');
    } else if (error.message.includes('Email not confirmed')) {
        showError('Please verify your email address before logging in.');
    } else if (error.message.includes('Invalid email')) {
        showError('Please enter a valid email address.');
        document.getElementById('student-email').classList.add('error');
    } else if (error.message.includes('User not found')) {
        showError('No account found with this email address.');
        document.getElementById('student-email').classList.add('error');
    } else {
        showError('Login failed: ' + error.message);
    }
}

// Allow form submission with Enter key
document.getElementById('student-email').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        document.getElementById('student-login-submit').click();
    }
});

document.getElementById('student-password').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        document.getElementById('student-login-submit').click();
    }
});

// Clear errors when user starts typing
document.getElementById('student-email').addEventListener('input', function() {
    this.classList.remove('error');
    document.getElementById('login-error').style.display = 'none';
});

document.getElementById('student-password').addEventListener('input', function() {
    this.classList.remove('error');
    document.getElementById('login-error').style.display = 'none';
});
        });
    </script>
</body>
</html>